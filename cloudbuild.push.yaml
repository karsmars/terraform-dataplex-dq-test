steps:
  - name: 'hashicorp/terraform:light'
    id: 'validate-format'
    entrypoint: sh
    args:
      - -c
      - |
        cd dataplex_infra
        echo "ğŸ§ª Initializing Terraform"
        terraform init -backend-config="backend-prod.tfbackend"

        echo "ğŸ” Validating Terraform configuration"
        terraform validate

        echo "ğŸ§¼ Checking Terraform formatting"
        if ! terraform fmt -check -diff -recursive; then
          echo ""
          echo "âŒ Terraform files are not properly formatted, but we still allow checks to pass"
          echo "ğŸ’¡ Run 'terraform fmt' locally and push the changes."
        else
          echo "âœ… Formatting looks good"
        fi

options:
  logging: CLOUD_LOGGING_ONLY
